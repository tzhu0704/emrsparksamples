spark-submit --deploy-mode client 
--packages org.apache.iceberg:iceberg-spark-runtime-3.5_2.12:1.6.1,software.amazon.s3tables:s3-tables-catalog-for-iceberg-runtime:0.1.3 
--conf spark.sql.catalog.glue_catalog=org.apache.iceberg.spark.SparkCatalog 
--conf spark.sql.catalog.glue_catalog.catalog-impl="org.apache.iceberg.aws.glue.GlueCatalog" 
--conf spark.sql.catalog.glue_catalog.io-impl="org.apache.iceberg.aws.s3.S3FileIO" 
--conf spark.sql.catalog.glue_catalog.warehouse="s3://emr-eks-spark-us-east-1-509399592849/example-prefix/" 
--conf spark.sql.catalog.s3tablesbucket=org.apache.iceberg.spark.SparkCatalog 
--conf spark.sql.catalog.s3tablesbucket.catalog-impl=software.amazon.s3tables.iceberg.S3TablesCatalog 
--conf spark.sql.catalog.s3tablesbucket.warehouse=arn:aws:s3tables:us-east-1:509399592849:bucket/my-s3-tablebucket0 
--conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions 
s3://emr-eks-spark-us-east-1-509399592849/eks-emr-spark/migratetos3tables.py * my-s3-tablebucket0


aws s3tables get-table --table-bucket-arn arn:aws:s3tables:us-east-1:509399592849:bucket/mys3tablebucket0 
aws s3tables get-table-maintenance-job-status --table-bucket-arn arn:aws:s3tables:us-east-1:509399592849:bucket/mys3tablebucket0 --namespace doeks_namespace --name employee_s3_table

spark-submit --deploy-mode cluster 
--packages org.apache.iceberg:iceberg-spark-runtime-3.5_2.12:1.6.1,software.amazon.s3tables:s3-tables-catalog-for-iceberg-runtime:0.1.3 
--conf spark.sql.catalog.glue_catalog=org.apache.iceberg.spark.SparkCatalog 
--conf spark.sql.catalog.glue_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog 
--conf spark.sql.catalog.glue_catalog.io-impl=org.apache.iceberg.aws.s3.S3FileIO 
--conf spark.sql.catalog.glue_catalog.warehouse=s3://emr-eks-spark-us-east-1-509399592849/example-prefix/ 
--conf spark.sql.catalog.s3tablesbucket=org.apache.iceberg.spark.SparkCatalog 
--conf spark.sql.catalog.s3tablesbucket.catalog-impl=software.amazon.s3tables.iceberg.S3TablesCatalog 
--conf spark.sql.catalog.s3tablesbucket.warehouse=arn:aws:s3tables:us-east-1:509399592849:bucket/mys3tablebucket10 
--conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions 
s3://emr-eks-spark-us-east-1-509399592849/eks-emr-spark/icebergtos3tables.py default mys3tablebucket10

--packages org.apache.iceberg:iceberg-spark-runtime-3.5_2.12:1.6.1,software.amazon.s3tables:s3-tables-catalog-for-iceberg-runtime:0.1.3 
--conf spark.sql.catalog.glue_catalog=org.apache.iceberg.spark.SparkCatalog 
--conf spark.sql.catalog.glue_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog 
--conf spark.sql.catalog.glue_catalog.warehouse='${S3blogbucket}'/example-prefix/ 
--conf spark.sql.catalog.glue_catalog.io-impl=org.apache.iceberg.aws.s3.S3FileIO 
--conf spark.sql.catalog.s3tablesbucket=org.apache.iceberg.spark.SparkCatalog 
--conf spark.sql.catalog.s3tablesbucket.catalog-impl=software.amazon.s3tables.iceberg.S3TablesCatalog 
--conf spark.sql.catalog.s3tablesbucket.warehouse=arn:aws:s3tables:'${AWS_REGION}':'${AWS_ACCOUNT_ID}':bucket/'${dest_bucket}' 
--conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions